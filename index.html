<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Inspirational Countdown & Fireworks</title>
  <style>
    /* Reset & base styles ------------------------------------------------- */
    :root{
      --bg1: #0f172a; /* deep navy */
      --bg2: #071124; /* almost black blue */
      --accent: #ffd166;
      --muted: rgba(255,255,255,0.15);
    }
    html,body{height:100%;margin:0;font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial}
    body{
      background: radial-gradient(1200px 800px at 20% 20%, rgba(20,40,90,0.35), transparent),
                  linear-gradient(180deg,var(--bg1),var(--bg2));
      color:#fff; overflow:hidden; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    }

    /* Full-screen container ------------------------------------------------ */
    .stage{
      position:relative; width:100vw; height:100vh; display:flex; align-items:center; justify-content:center;
    }

    /* Quote card ------------------------------------------------------------ */
    .quote-wrap{
      position:absolute; inset:0; display:flex; align-items:center; justify-content:center; pointer-events:none;
    }
    .quote-card{
      max-width:90%; width:900px;
      /* removed background to let quotes display directly over the stage */
      background: transparent;
      border-radius:0; padding:12px 24px; box-shadow:none; border:none;
      transform-origin:center; text-align:center;
    }
    .quote-text{ font-size:clamp(18px, 2.4vw, 30px); line-height:1.35; margin:0; opacity:0}
    .quote-year{ margin-top:14px; color:var(--muted); font-weight:600; letter-spacing:0.08em; font-size:14px; opacity:0}

    /* transition classes */
    .in { animation: quoteIn 700ms ease forwards }
    .out { animation: quoteOut 700ms ease forwards }
    @keyframes quoteIn { from{ transform: translateY(12px) scale(0.98); opacity:0 } to{ transform: translateY(0) scale(1); opacity:1 } }
    @keyframes quoteOut { from{ transform: translateY(0) scale(1); opacity:1 } to{ transform: translateY(-12px) scale(0.98); opacity:0 } }

    /* Countdown number ----------------------------------------------------- */
    .countdown{
      position:absolute; inset:0; display:flex; align-items:center; justify-content:center; pointer-events:none;
      font-weight:800; font-variant-numeric:tabular-nums;
    }
    .count-num{
      font-size: clamp(72px, 18vw, 320px); line-height:0.8; transform-origin:center; opacity:0; color:#fff;
      text-shadow: 0 6px 30px rgba(0,0,0,0.6), 0 4px 24px rgba(255,255,255,0.02);
    }
    .pop{ animation: pop 820ms cubic-bezier(.22,.9,.3,1) forwards }
    @keyframes pop{ 0%{ transform: scale(0.2) rotate(-6deg); opacity:0 } 40%{ transform: scale(1.18) rotate(2deg); opacity:1 } 100%{ transform: scale(1); opacity:1 } }

    /* Controls -------------------------------------------------------------- */
    .controls{ position:absolute; bottom:28px; left:28px; display:flex; gap:12px }
    button.btn{ background:linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03)); color:#fff; border:1px solid rgba(255,255,255,0.06); padding:10px 14px; border-radius:10px; font-weight:700; cursor:pointer }
    button.btn:disabled{ opacity:0.45; cursor:not-allowed }

    /* small footer info */
    .info{ position:absolute; right:20px; bottom:18px; color:var(--muted); font-size:12px }

    /* canvas fills the stage */
    canvas{ position:absolute; inset:0; width:100%; height:100%; display:block; }

    /* small sparkle overlay for subtle visual interest */
    .stars{ position:absolute; inset:0; pointer-events:none; }
    .credits{ position:absolute; top:14px; left:18px; color:var(--muted); font-size:13px }

    /* Happy New Year message ------------------------------------------------ */
    .happy-msg{
      position:absolute;
      left:50%;
      top:46%;
      transform:translate(-50%,-50%) scale(0.96);
      font-weight:900;
      font-size:clamp(44px, 10vw, 144px);
      line-height:0.9;
      letter-spacing:0.02em;
      text-align:center;
      pointer-events:none;
      opacity:0;
      transition:opacity 500ms ease, transform 700ms cubic-bezier(.2,.9,.25,1);
      -webkit-background-clip: text;
      background-clip: text;
      color:transparent;
      background-image: linear-gradient(90deg, #FFD166, #FF7A7A, #8BD3FF, #B993FF);
      text-shadow: 0 8px 30px rgba(0,0,0,0.6), 0 2px 12px rgba(255,255,255,0.04);
      filter: drop-shadow(0 6px 20px rgba(0,0,0,0.6));
    }
    .happy-msg.show{
      opacity:1;
      transform:translate(-50%,-50%) scale(1);
      animation: msgGlow 2.6s ease-in-out infinite;
    }
    .happy-msg.hide{
      opacity:0;
      transform:translate(-50%,-50%) scale(0.96);
      animation:none;
    }
    @keyframes msgGlow {
      0%{ filter: drop-shadow(0 8px 20px rgba(255,160,64,0.08)) blur(0px); }
      50%{ filter: drop-shadow(0 18px 40px rgba(255,160,64,0.26)) blur(0px); transform: translate(-50%,-50%) scale(1.03); }
      100%{ filter: drop-shadow(0 8px 20px rgba(255,160,64,0.08)) blur(0px); }
    }

    @media (max-width:640px){ .quote-card{ padding:22px } }
  </style>
</head>
<body>
  <div class="stage" id="stage">

    <canvas id="canvas"></canvas>

    <div class="quote-wrap" id="quoteWrap">
      <div class="quote-card" role="status" aria-live="polite">
        <p class="quote-text" id="quoteText">"..."</p>
        <div class="quote-year" id="quoteYear">— year</div>
      </div>
    </div>

    <div class="countdown" id="countdown" aria-hidden="true">
      <div class="count-num" id="countNum">10</div>
    </div>

    <!-- Centered celebratory message shown when countdown reaches zero -->
    <div class="happy-msg hide" id="happyMsg" aria-live="polite" aria-hidden="true">Happy New Year</div>



    <div class="info">Developed by Rell using copilot tool ✨</div>
  </div>

  <script>
    /* ----------------------- Utilities & helpers --------------------------- */
    function wait(ms){ return new Promise(res=>setTimeout(res, ms)); }

    /* ----------------------- Quote Manager -------------------------------- */
    class QuoteManager {
      constructor({ elText, elYear, quotes, displayMs = 3000, transitionMs = 700 }){
        this.elText = elText; this.elYear = elYear; this.quotes = quotes; this.displayMs = displayMs; this.transitionMs = transitionMs;
      }

      async start(){
        // Show quotes sequentially with an entrance and exit animation
        for(let i=0;i<this.quotes.length;i++){
          const q = this.quotes[i];
          this.elText.textContent = '"' + q.text + '"';
          this.elYear.textContent = '— ' + q.year + (q.author? ' • ' + q.author : '');

          // animate in
          this.elText.classList.remove('out'); this.elYear.classList.remove('out');
          this.elText.classList.add('in'); this.elYear.classList.add('in');

          await wait(this.displayMs);

          // animate out
          this.elText.classList.remove('in'); this.elYear.classList.remove('in');
          this.elText.classList.add('out'); this.elYear.classList.add('out');

          await wait(this.transitionMs);
        }
      }
    }

    /* ----------------------- Countdown Manager ---------------------------- */
    class CountdownManager {
      constructor({ el, startFrom = 10 }){
        this.el = el; this.startFrom = startFrom; this.resolve = null;
      }
      // start({ showZero = true }) - set showZero=false to avoid displaying the final 0
      async start({ showZero = true } = {}){
        const numEl = this.el.querySelector('.count-num') || this.el;
        const end = showZero ? 0 : 1; // don't show zero if showZero is false
        for(let i = this.startFrom; i >= end; i--){
          numEl.textContent = i;
          numEl.classList.remove('pop');
          // force reflow to restart CSS animation
          void numEl.offsetWidth;
          numEl.classList.add('pop');
          await wait(1000);
        }
        // small buffer if we skipped zero so the transition feels natural
        if(!showZero) await wait(400);
      }
    }

    /* ----------------------- Fireworks Engine ----------------------------- */
    class FireworksEngine {
      constructor(canvas){
        this.canvas = canvas; this.ctx = canvas.getContext('2d');
        this.rocketTimer = 0; this.rockets = []; this.particles = []; this.running = false;
        this.width = 0; this.height = 0; this._boundUpdate = this.update.bind(this);
        // starfield background and cinematic timers
        this.stars = []; this.starCount = Math.floor((innerWidth/120) * (innerHeight/220));
        this.overlapTimer = 900 + Math.random()*2200; // overlapping explosions timer
        this.cinematicTimer = 2500 + Math.random()*4000; // occasional big cinematic burst
        this.resize(); window.addEventListener('resize', ()=>this.resize());
        this._initStarfield();
      }
      resize(){ this.canvas.width = this.width = innerWidth; this.canvas.height = this.height = innerHeight; this.starCount = Math.floor((innerWidth/120) * (innerHeight/220)); this._initStarfield(); }

      _initStarfield(){
        this.stars.length = 0;
        for(let i=0;i<this.starCount;i++){
          this.stars.push({
            x: Math.random()*this.width,
            y: Math.random()*this.height,
            r: Math.random()*1.6 + 0.3,
            a: 0.3 + Math.random()*0.8,
            tw: Math.random()*3000 + 2000
          });
        }
      }

      start(){ if(this.running) return; this.running = true; this.lastTime = performance.now(); this.rocketTimer = 0; this.loop(); }
      stop(){ this.running=false; }

      loop(){ this.raf = requestAnimationFrame(this._boundUpdate); }

      update(t){
        if(!this.running) { cancelAnimationFrame(this.raf); return; }
        const dt = Math.min(60, t - (this.lastTime||t)); this.lastTime = t;
        this.ctx.clearRect(0,0,this.width,this.height);

        // draw subtle starfield behind fireworks for cinematic depth
        this.ctx.globalCompositeOperation = 'source-over';
        for(let i=0;i<this.stars.length;i++){
          const s = this.stars[i];
          // twinkle
          const tw = (1 + Math.sin((t + i*37) / s.tw * Math.PI*2))*0.5;
          this.ctx.fillStyle = `rgba(255,255,255,${s.a*tw})`;
          this.ctx.beginPath(); this.ctx.arc(s.x, s.y, s.r, 0, Math.PI*2); this.ctx.fill();
        }

        // additive blending for bright fireworks
        this.ctx.globalCompositeOperation = 'lighter';

        // spawn random rockets frequently: varied timing (more aggressive for lively show)
        this.rocketTimer -= dt;
        if(this.rocketTimer <= 0){ this.launchRocket(); this.rocketTimer = 120 + Math.random()*380; }

        // overlapping explosions timer
        this.overlapTimer -= dt;
        if(this.overlapTimer <= 0){ this.triggerOverlap(); this.overlapTimer = 600 + Math.random()*2000; }

        // cinematic large bursts occasionally
        this.cinematicTimer -= dt;
        if(this.cinematicTimer <= 0){ this.celebrationBurst(3 + Math.floor(Math.random()*6)); this.cinematicTimer = 4000 + Math.random()*8000; }

        // update rockets
        for(let i=this.rockets.length-1;i>=0;i--){
          const r = this.rockets[i]; r.update(dt);
          r.draw(this.ctx);
          if(r.shouldExplode()){
            // if rocket.streak, produce streak-styled particles
            if(r.streak){ this.explode(r); this._explodeAsStreak(r); }
            else this.explode(r);
            this.rockets.splice(i,1);
          }
        }

        // update particles
        for(let i=this.particles.length-1;i>=0;i--){
          const p = this.particles[i]; p.update(dt); p.draw(this.ctx);
          if(p.dead) this.particles.splice(i,1);
        }

        // soft glow overlay for cinematic effect
        this.ctx.globalCompositeOperation = 'source-over';
        this.ctx.fillStyle = 'rgba(0,0,0,0.12)';
        this.ctx.fillRect(0,0,this.width,this.height);

        this.loop();
      }

      launchRocket(){
        // choose a base launch X and generate 1-4 rockets (clusters) for overlapping explosions
        const baseX = 0.08*this.width + Math.random()*0.84*this.width;
        const y = this.height + 10;
        const cluster = 1 + Math.floor(Math.random()*3);
        for(let i=0;i<cluster;i++){
          const x = baseX + (i- (cluster-1)/2) * (12 + Math.random()*28);
          const tx = x + (Math.random()-0.5)*220;
          // randomize height more aggressively for chaotic show
          const ty = this.height* (0.07 + Math.random()*0.72);
          const hue = Math.floor(Math.random()*360);
          const r = new Rocket(x,y,tx,ty,hue);
          // small chance to spawn a 'fast' streak rocket (explodes into streak particles)
          r.streak = Math.random() < 0.12;
          this.rockets.push(r);
        }
      }

      explode(rocket){
        // choose explosion style randomly
        const styles = ['burst','ring','spiral','flower'];
        const style = styles[Math.floor(Math.random()*styles.length)];
        const pcount = 18 + Math.floor(Math.random()*40);

        switch(style){
          case 'burst': this.explodeBurst(rocket, pcount); break;
          case 'ring': this.explodeRing(rocket, pcount); break;
          case 'spiral': this.explodeSpiral(rocket, pcount); break;
          case 'flower': this.explodeFlower(rocket, pcount); break;
        }
      }

      explodeBurst(r, count){
        const {x,y,hue} = r;
        for(let i=0;i<count;i++){
          const angle = Math.random()*Math.PI*2;
          const speed = 1.8 + Math.random()*3.8;
          const vx = Math.cos(angle)*speed; const vy = Math.sin(angle)*speed;
          const color = `hsl(${(hue + (Math.random()*80-40))|0}deg, 85%, ${45 + Math.random()*25}%)`;
          this.particles.push(new Particle(x,y,vx,vy,color, 900 + Math.random()*900));
        }
      }

      explodeRing(r, count){
        const {x,y,hue} = r;
        const radius = 12 + Math.random()*36;
        for(let i=0;i<count;i++){
          const angle = (i/count) * Math.PI*2 + (Math.random()*0.12);
          const vx = Math.cos(angle)*(radius/8); const vy = Math.sin(angle)*(radius/8);
          const color = `hsl(${(hue + i*7)|0}deg, 85%, ${50}%)`;
          // ring particles get outward push + gravity to fall as a ring
          this.particles.push(new Particle(x + Math.cos(angle)*radius, y + Math.sin(angle)*radius, vx*1.6, vy*1.6, color, 1200 + Math.random()*800));
        }
      }

      explodeSpiral(r, count){
        const {x,y,hue} = r;
        const arms = 2 + Math.floor(Math.random()*3);
        for(let i=0;i<count;i++){
          const t = i/(count)*Math.PI*2;
          const arm = i % arms;
          const angle = t + arm*(Math.PI*2/arms);
          const rad = 0.6*(i/count)*40 + 4 + Math.random()*8;
          const vx = Math.cos(angle)*rad/12; const vy = Math.sin(angle)*rad/12;
          const color = `hsl(${(hue + arm*60)|0}deg, 90%, ${45 + Math.random()*20}%)`;
          this.particles.push(new Particle(x,y,vx,vy,color,1200 + Math.random()*1200, {twinkle:true}));
        }
      }

      explodeFlower(r, count){
        // layered bursts with inner glints
        const {x,y,hue} = r;
        const outer = count; const inner = Math.floor(count*0.25);
        this.explodeBurst(r, outer);
        for(let i=0;i<inner;i++){
          const angle = Math.random()*Math.PI*2;
          const speed = 0.8 + Math.random()*1.6;
          const color = `hsl(${(hue + 180 + (Math.random()*40-20))|0}deg, 85%, ${60}%)`;
          this.particles.push(new Particle(x,y,Math.cos(angle)*speed,Math.sin(angle)*speed,color,700 + Math.random()*500, {fade:0.03}));
        }
      }

      // create several large, colorful bursts near center for a polished celebration
      celebrationBurst(count=6){
        const cx = this.width/2; const cy = this.height*0.32;
        for(let i=0;i<count;i++){
          const hue = Math.floor(Math.random()*360);
          const fake = { x: cx + (Math.random()-0.5)*240, y: cy + (Math.random()-0.5)*90, hue };
          const styles = ['burst','ring','spiral','flower'];
          const style = styles[Math.floor(Math.random()*styles.length)];
          const pcount = 28 + Math.floor(Math.random()*64);
          switch(style){
            case 'burst': this.explodeBurst(fake, pcount); break;
            case 'ring': this.explodeRing(fake, pcount); break;
            case 'spiral': this.explodeSpiral(fake, pcount); break;
            case 'flower': this.explodeFlower(fake, pcount); break;
          }
        }
      }

      // overlapping small bursts at random heights for more chaos
      triggerOverlap(){
        const groups = 1 + Math.floor(Math.random()*4);
        for(let g=0; g<groups; g++){
          const x = 0.08*this.width + Math.random()*0.84*this.width;
          const y = this.height* (0.08 + Math.random()*0.78);
          const hue = Math.floor(Math.random()*360);
          const style = ['burst','ring','spiral','flower'][Math.floor(Math.random()*4)];
          const pcount = 8 + Math.floor(Math.random()*28);
          const fake = { x, y, hue };
          switch(style){
            case 'burst': this.explodeBurst(fake, pcount); break;
            case 'ring': this.explodeRing(fake, pcount); break;
            case 'spiral': this.explodeSpiral(fake, pcount); break;
            case 'flower': this.explodeFlower(fake, pcount); break;
          }
        }
      }

      // produce streak-like explosion for special rockets
      _explodeAsStreak(r){
        const {x,y,hue} = r;
        const count = 12 + Math.floor(Math.random()*38);
        for(let i=0;i<count;i++){
          const angle = Math.random()*Math.PI*2;
          const speed = 3 + Math.random()*6;
          const vx = Math.cos(angle)*speed; const vy = Math.sin(angle)*speed;
          const color = `hsl(${(hue + (Math.random()*80-40))|0}deg, 85%, ${50 + Math.random()*25}%)`;
          this.particles.push(new Particle(x,y,vx,vy,color, 900 + Math.random()*800, { type: 'streak', size: 1 + Math.random()*2 }));
        }
      }
    }

    /* ----------------------- Rocket & Particle models --------------------- */
    class Rocket{
      constructor(x,y,tx,ty,hue){ this.x = x; this.y = y; this.tx = tx; this.ty = ty; this.hue = hue; this.vx = (tx - x)/80; this.vy = (ty - y)/80; this.age = 0; }
      update(dt){ this.x += this.vx * (dt/16); this.y += this.vy * (dt/16); this.vy += 0.04 * (dt/16); this.age += dt; }
      draw(ctx){ ctx.save(); ctx.beginPath(); const grd = ctx.createRadialGradient(this.x,this.y,0,this.x,this.y,18); grd.addColorStop(0, `hsla(${this.hue},90%,70%,1)`); grd.addColorStop(1, `hsla(${this.hue},90%,50%,0)`); ctx.fillStyle = grd; ctx.fillRect(this.x-2,this.y-2,4,4); ctx.restore(); }
      shouldExplode(){ return this.y <= this.ty || this.age > 3500; }
    }

    class Particle{
      constructor(x,y,vx,vy,color,life=1200, opts={}){
        this.x = x; this.y = y; this.vx = vx; this.vy = vy; this.color = color; this.life = life; this.age = 0; this.dead = false; this.opts = opts || {}; this.size = (opts.size || (1 + Math.random()*3)); this.opacity = 1; this.type = opts.type || 'circle'; this.rotation = Math.random()*Math.PI*2; this.spin = (Math.random()-0.5)*0.08;
      }
      update(dt){
        this.age += dt; if(this.age >= this.life) this.dead = true; const t = dt/16;
        // physics
        this.vy += 0.04 * t; this.x += this.vx * t * 0.92; this.y += this.vy * t * 0.92;
        // rotation for stars/streaks
        this.rotation += this.spin * t;
        // opacity and optional twinkle
        if(this.opts.twinkle && Math.random() < 0.06) this.opacity = 0.6 + Math.random()*0.6;
        if(this.opts.fade) this.opacity -= this.opts.fade * t; else this.opacity = Math.max(0, 1 - this.age/this.life);
      }
      draw(ctx){
        ctx.save(); ctx.globalCompositeOperation = 'lighter';
        if(this.type === 'circle'){
          const g = ctx.createRadialGradient(this.x,this.y,0,this.x,this.y,this.size*6);
          g.addColorStop(0, this.color);
          g.addColorStop(0.5, this.color);
          g.addColorStop(1, 'rgba(0,0,0,0)');
          ctx.fillStyle = g; ctx.beginPath(); ctx.arc(this.x,this.y,this.size,0,Math.PI*2); ctx.fill();
        } else if(this.type === 'star'){
          // draw a small glowing star
          const r = this.size*2.2;
          ctx.translate(this.x,this.y); ctx.rotate(this.rotation);
          ctx.fillStyle = this.color;
          ctx.beginPath();
          for(let i=0;i<5;i++){
            ctx.lineTo(Math.cos(i*Math.PI*2/5)*r, Math.sin(i*Math.PI*2/5)*r);
            ctx.lineTo(Math.cos((i+0.5)*Math.PI*2/5)*r*0.45, Math.sin((i+0.5)*Math.PI*2/5)*r*0.45);
          }
          ctx.closePath();
          ctx.globalAlpha = Math.min(1, this.opacity);
          ctx.fill();
        } else if(this.type === 'streak'){
          // streak: draw elongated particle aligned to velocity vector
          const angle = Math.atan2(this.vy, this.vx);
          const length = Math.max(8, this.size*8 + Math.hypot(this.vx,this.vy)*6);
          ctx.translate(this.x,this.y); ctx.rotate(angle);
          const grad = ctx.createLinearGradient(-length/2,0,length/2,0);
          grad.addColorStop(0, 'rgba(255,255,255,0)');
          grad.addColorStop(0.35, this.color);
          grad.addColorStop(1, 'rgba(0,0,0,0)');
          ctx.fillStyle = grad; ctx.globalAlpha = Math.min(1, this.opacity);
          ctx.beginPath(); ctx.ellipse(0,0,length/2,this.size,0,0,Math.PI*2); ctx.fill();
        }
        ctx.restore();
      }
    }

    /* ----------------------- Initialize & Hook UI ------------------------ */
    (function main(){
      const canvas = document.getElementById('canvas'); const engine = new FireworksEngine(canvas);

      // Quotes - choose a series of inspirational quotes from past years
      const quotes = [
  { year: 2017, text: "Small steps every day lead to remarkable achievements.", author: "Robert Collier" },
  { year: 2018, text: "Curiosity fuels the mind to explore endless possibilities.", author: "Albert Einstein" },
  { year: 2019, text: "Courage is moving forward even when fear whispers.", author: "Mark Twain" },
  { year: 2020, text: "Adaptability is the key to survival and growth.", author: "Charles Darwin" },
  { year: 2021, text: "Together, we can build resilient and thriving futures.", author: "Helen Keller" },
  { year: 2022, text: "Create more than you consume, leave a legacy.", author: "Richard Branson" },
  { year: 2023, text: "Kindness is the investment that always pays dividends.", author: "Dalai Lama" },
  { year: 2024, text: "Learn boldly, fail forward, and embrace the journey.", author: "John C. Maxwell" },
  { year: 2025, text: "The future is crafted by what we do today.", author: "Peter Drucker" }
];

      const quoteMgr = new QuoteManager({ elText: document.getElementById('quoteText'), elYear: document.getElementById('quoteYear'), quotes, displayMs: 2800, transitionMs: 600 });
      const countdownEl = document.getElementById('countdown');
      const countdownMgr = new CountdownManager({ el: countdownEl, startFrom: 10 });



      const messageEl = document.getElementById('happyMsg');
      let msgTimer = null;
      // showMessage now accepts a text and returns a Promise that resolves when hidden
      let _msgResolve = null;
      function showMessage(text = 'Happy New Year', duration = 10000){
        if(!messageEl) return Promise.resolve();
        // clear any previous timer and promise
        clearTimeout(msgTimer); if(_msgResolve){ _msgResolve(); _msgResolve = null; }
        messageEl.textContent = text;
        messageEl.classList.remove('hide');
        messageEl.classList.add('show');
        messageEl.setAttribute('aria-hidden','false');
        return new Promise(resolve => {
          _msgResolve = () => { resolve(); _msgResolve = null; };
          msgTimer = setTimeout(()=>{ hideMessage(); if(_msgResolve) { _msgResolve(); } }, duration);
        });
      }
      function hideMessage(){
        if(!messageEl) return;
        messageEl.classList.remove('show');
        messageEl.classList.add('hide');
        messageEl.setAttribute('aria-hidden','true');
        clearTimeout(msgTimer); msgTimer = null;
        if(_msgResolve){ _msgResolve(); _msgResolve = null; }
      }

      // quick white radial flash to accent the transition (ephemeral element)
      function flashOnce(){
        const f = document.createElement('div');
        f.style.position = 'fixed'; f.style.left = 0; f.style.top = 0; f.style.width = '100%'; f.style.height = '100%';
        f.style.background = 'radial-gradient(ellipse at center, rgba(255,255,240,0.9) 0%, rgba(255,255,255,0.25) 40%, rgba(255,255,255,0) 70%)';
        f.style.pointerEvents = 'none'; f.style.opacity = 0; f.style.transition = 'opacity 220ms ease-out, transform 280ms ease-out';
        f.style.transform = 'scale(0.98)';
        document.body.appendChild(f);
        requestAnimationFrame(()=>{ f.style.opacity = 1; f.style.transform = 'scale(1)'; });
        setTimeout(()=>{ f.style.opacity = 0; f.style.transform = 'scale(1.02)'; }, 180);
        setTimeout(()=>{ if(f.parentNode) f.parentNode.removeChild(f); }, 420);
      }

      let running = false;

      async function runSequence(){
        // mark running and hide any lingering celebratory message
        running = true; hideMessage();

        // Ensure quote area visible and countdown hidden
        document.getElementById('quoteWrap').style.opacity = 1;
        countdownEl.style.opacity = 0;

        // Play the quotes
        await quoteMgr.start();

        // Transition to countdown
        document.getElementById('quoteWrap').style.opacity = 0;
        countdownEl.style.opacity = 1;
        await wait(380);

        // Start countdown (do NOT show the final '0')
        await countdownMgr.start({ showZero: false });

        // hide/clear the visible countdown number immediately so only the message remains
        countdownEl.style.opacity = 0;
        const numEl = countdownEl.querySelector('.count-num'); if(numEl) numEl.textContent = '';

        // quick flash and a polished center burst before launching the main fireworks
        flashOnce(); engine.celebrationBurst(6);

        // Launch main fireworks
        engine.start();

        // Show celebratory message (Happy New Year), then Welcome 2026 and a short motivational sequence
        await showMessage('Happy New Year', 10000);
        // after the NY message, show Welcome 2026 briefly
        await showMessage('Welcome 2026!', 4500);

        // now transition to show motivational quotes for 2026
        // ensure the quote area is visible and the message is hidden
        hideMessage();
        document.getElementById('quoteWrap').style.opacity = 1;
        countdownEl.style.opacity = 0;

        const quotes2026 = [
          { year: 2026, text: "Don't show the past, make this now. Be thankful you are still alive today. God always has a better plan.", author: 'Rell' },
          { year: 2026, text: 'Make today so productive that tomorrow becomes optional.', author: 'Motivation' },
          { year: 2026, text: 'New year, new focus: be kinder, act quicker, and finish what you start.', author: 'Community' }
        ];
        const specialQuoteMgr = new QuoteManager({ elText: document.getElementById('quoteText'), elYear: document.getElementById('quoteYear'), quotes: quotes2026, displayMs: 3800, transitionMs: 600 });
        await specialQuoteMgr.start();

        // Keep fireworks running but don't block
        running = false;
      }

      // Auto-start the sequence on load
      // (Buttons removed - sequence begins automatically)

      // tjis is not belongs to 
      async function restartSequence(){
        engine.stop(); hideMessage();
        await wait(200);
        runSequence();
      }

      // small performance tip: pause/resume when the tab visibility changes
      document.addEventListener('visibilitychange', ()=>{
        if(document.hidden){
          if(engine.running){ engine._wasRunning = true; engine.stop(); }
        } else {
          if(engine._wasRunning){ engine.start(); engine._wasRunning = false; }
        }
      });

      // auto-start after a short delay so the page can render
      setTimeout(()=>{ runSequence(); }, 250);

    })();

    /* ---------------------------------------------------------------------- */
  </script>
</body>
</html>